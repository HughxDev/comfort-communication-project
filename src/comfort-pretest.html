<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/neon-animation/web-animations.html">
<link rel="import" href="../bower_components/neon-animation/animations/scale-up-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/fade-out-animation.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="comfort-button.html">
<link rel="import" href="comfort-test.html">

<dom-module id="comfort-pretest">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
      }

      .lets-begin {
        width: 549px;
        margin-bottom: 40px;
        text-align: center;
      }

      p {
        @apply --breathe;
      }
    </style>

    <section>
      <header>
        <p class="h3 section-subtitle">Section 1</p>
        <h1 class="section-title">Pre-test</h1>
      </header>
      
      <p>Before you begin this module on family caregivers, complete this short pretest to assess your baseline knowledge:</p>

      <comfort-test id="pretest"></comfort-test>

      <hr />

      <p class="lets-begin">Now that you have finished the pretest, let’s begin. This module will take about 30 minutes to complete. Once finished, you will take a post-test to assess your learning. If you are not satisfied with the results, feel free to go through the module again. You can do so as many times as you’d like to—until you are satisfied with your post-test results.</p>

      <comfort-button id="next" on-tap="checkForAnswers" href="/introduction/">Start course</comfort-button>
    
      <paper-dialog id="missing-answers" entry-animation="scale-up-animation" exit-animation="fade-out-animation">
        <h2>Missing required field(s)</h2>
        <div>Please go back and make sure you’ve answered every question.</div>
      </paper-dialog>
    </section>
  </template>

  <script>
    "use strict";

    class ComfortPretest extends Comfort.CorrectIncorrect( Comfort.PseudoForm( Polymer.GestureEventListeners( Polymer.Element ) ) ) {
      static get is() { return 'comfort-pretest'; }

      checkForAnswers( event ) {
        const $pretest = this.shadowRoot.querySelector( '#pretest' );
        const $missingAnswers = this.shadowRoot.querySelector( '#missing-answers' );

        var answered = $pretest.checkForAnswers();

        if ( answered ) {
          // this._storeAnswers
          $pretest._storeAnswers();
        } else {
          event.preventDefault();

          $missingAnswers.open();
        }
      }

      // _storeAnswers() {
      //   const $pretest = this.shadowRoot.querySelector( '#pretest' );

      //   $pretest._storeAnswers();
      // }
    }

    window.customElements.define( ComfortPretest.is, ComfortPretest );
  </script>
</dom-module>
